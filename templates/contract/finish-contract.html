<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>评价合同</title>
    <link rel="stylesheet" type="text/css" href="/static/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="/static/css/custom.css">
    <link rel="stylesheet" type="text/css" href="/static/css/redefine.css">
    <link rel="stylesheet" type="text/css" href="/static/css/yunzujiaicons.css">
    <link rel="stylesheet" type="text/css" href="/static/common/css/base.css">
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
</head>
  <body>
    <div>
      <!--头部-->
      <header class="header-navbar">
        <nav class="navbar navbar-default">
        <div class="container">
          {% include "header.html" %}
        </div>
        {% include "header-my.html" %}
        </nav>
      </header>

      <div class="container yzj-size-14" id="container">
        <input type="hidden" value="{{user.identify[0]}}" v-model="role"/>
        <div class="alert alert-success yzj-top-distance10 yzj-bot-distance30 " role="alert">
        {% if user.identify[0] == "c" %}
          你的合同已经结束，请留下对“服务方”的反馈。
        {% else %}
          你的合同已经结束，请留下对“需求方”的反馈。
        {% endif %}
        </div>
        <h4 class="text-muted yzj-top-distance20 yzj-bot-distance20"><strong>评价
        {% if user.identify[0] == "c" %}
          {[contract.user.freelancer.name]}
        {% else %}
          {[contract.user.client.name]}
        {% endif %}
         -- {[contract.name]}</strong></h4>
        <!-- <div v-for="item in contract.stones" v-if="item.status == 'carry'">
          <p class="yzj-size-16 text-muted yzj-top-distance20">您要结束的合同【{[contract.name]}】的里程碑【{[item.name]}】（{[item.amount]}元）正在进行中，请选择</p>
          <div class="yzj-size-16 text-info yzj-height30-real yzj-top-distance10">
            <p><input type="radio" name="is_pay" v-model="is_pay" value="1" />支付 ¥ {[item.amount]}元</p>
            <p><input type="radio" name="is_pay" v-model="is_pay" value="0"/>不支付 - 退还我的押金{[item.amount]}元</p>
            <p class="yzj-size-14 text-primary" style="margin-left:30px;" v-show="is_pay=='0'">您的退款申请将提交至客服处理，2个工作日内客服人员会联系您，请注意接听电话!同时我们也会将您的申请通知服务方</p>
          </div>
        </div> -->
        <p class="yzj-size-16 text-info yzj-top-distance20">
        {% if user.identify[0] == "c" %}
          分享你的经验，你的反馈将会对服务方和云沃客平台提供有价值的信息
        {% else %}
          分享你的经验，你的反馈将会对需求方和云沃客平台提供有价值的信息
        {% endif %}
        </p>
        <div class="yzj-top-distance20 yzj-box">
          <div class="col-xs-1 clear-left" style="width: 5%;"><i class="evaluate-secrecy"></i></div>
          <div class="col-xs-8 clear-left yzj-top-distance15">
            <p class="text-info yzj-size-16"><strong>保密评价</strong></p>
            <p class="text-info yzj-top-distance20">评价将匿名并不会直接展示给对方</p>
            <p class="text-info yzj-size-16 yzj-top-distance20"><strong>结束合同的原因</strong></p>
            <select class="form-control yzj-top-distance20" style="width:420px" v-model="question_id">
              <option v-for="item in question" v-bind:value="item.question_id">{[item.name]}</option>
            </select>
            <p class="text-info yzj-size-16 yzj-top-distance20"><strong>
            {% if user.identify[0] == "c" %}
              你是否愿意将这个服务方推荐给你的朋友或者同行
            {% else %}
              你是否愿意将这个需求方推荐给你的朋友或者同行
            {% endif %}</strong>
            </p>
            <div class="evaluate-div yzj-top-distance20 yzj-bot-distance50">
              <span>一点也不想</span>
              <span v-for="n in 11"><input type="radio" value="{[n]}" name="score" v-model="score"/>{[n]}</span>
              <span>非常乐意</span>
            </div>
          </div>
          <div class="clearfix"></div>
        </div>

        <div class="yzj-top-distance20 yzj-box">
          <div class="col-xs-1 clear-left" style="width: 5%;"><i class="evaluate-open"></i></div>
          <div class="col-xs-8 clear-left yzj-top-distance15">
            <p class="text-info yzj-size-16"><strong>公开评价</strong></p>
            <p class="text-info yzj-top-distance20">
            {% if user.identify[0] == "c" %}
              双方互评之后，该评价将展示在服务方的档案中
            {% else %}
              双方互评之后，该评价将展示在需求方的档案中
            {% endif %}
            </p>
            <div class="text-info yzj-top-distance30">
            {% if user.identify[0] == "c" %}
              <ul class="start_list">          
                <li>
                  <div id="evaluate1"></div>
                  <input type='hidden' id="e1" v-model="evaluate[0]"/>
                  <em>沟通</em>
                  <div class="clearfix"></div>
                </li>
                <li>
                  <div id="evaluate2"></div>
                  <input type='hidden' id="e2" v-model="evaluate[1]"/>
                  <em>守时率</em>
                  <div class="clearfix"></div>
                </li>
                <li>
                  <div id="evaluate3"></div>
                  <input type='hidden' id="e3" v-model="evaluate[2]"/>
                  <em>合作</em>
                  <div class="clearfix"></div>
                </li>
                <li>
                  <div id="evaluate4"></div>
                  <input type='hidden' id="e4" v-model="evaluate[3]"/>
                  <em>工作质量</em>
                  <div class="clearfix"></div>
                </li>
                <li>
                  <div id="evaluate5"></div>
                  <input type='hidden' id="e5" v-model="evaluate[4]"/>
                  <em>技能</em>
                  <div class="clearfix"></div>
                </li>
              </ul>
            {% else %}
              <ul class="start_list">          
                <li>
                  <div id="evaluate1"></div>
                  <input type='hidden' id="e1" v-model="evaluate[0]"/>
                  <em>沟通</em>
                  <div class="clearfix"></div>
                </li>
                <li>
                  <div id="evaluate2"></div>
                  <input type='hidden' id="e2" v-model="evaluate[1]"/>
                  <em>合作</em>
                  <div class="clearfix"></div>
                </li>
                <li>
                  <div id="evaluate3"></div>
                  <input type='hidden' id="e3" v-model="evaluate[2]"/>
                  <em>需求质量</em>
                  <div class="clearfix"></div>
                </li>
                <li>
                  <div id="evaluate4"></div>
                  <input type='hidden' id="e4" v-model="evaluate[3]"/>
                  <em>可用性</em>
                  <div class="clearfix"></div>
                </li>
                <li>
                  <div id="evaluate5"></div>
                  <input type='hidden' id="e5" v-model="evaluate[4]"/>
                  <em>合理设置交付时间</em>
                  <div class="clearfix"></div>
                </li>
                <li>
                  <div id="evaluate6"></div>
                  <input type='hidden' id="e6" v-model="evaluate[5]"/>
                  <em>技能</em>
                  <div class="clearfix"></div>
                </li>
              </ul>
            {% endif %}
            </div>
            <p class="text-warning yzj-size-16 yzj-top-distance10"><strong>总分：<span id="score">0</span>分</strong></p>
            <p class="text-info yzj-size-16 yzj-top-distance40"><strong>分享与其合作的感受</strong></p>
            <textarea class="yzj-top-distance20 bidTextarea" rows="7" v-model="content"></textarea>
            <div class="yzj-top-distance50 yzj-bot-distance50 col-xs-7 clear-left">
              <div class="col-xs-6 clear-left">
                <input type="button" value="提交评价" class="btn btn-primary btn-block" v-on:click="finish_contract">
              </div>
              <div class="col-xs-6 clear-left">
                <input type="button" value="取消" class="btn btn-default btn-block" onclick="history.go(-1)">
              </div>
            </div>
          </div>
          <div class="clearfix"></div>
        </div>
        <alert :msg="error_msg"></alert>

      </div>
      {% include "footer.html" %}
    </div>
    <script src="/static/js/jquery-2.1.4.min.js"></script> 
    <script src="/static/js/vue.min.js"></script>
    <script src="/static/js/js.cookie.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <script src="/static/js/editicon-dis.js"></script>
    <script src="/static/common/js/yunwork.js"></script>
    <script src="/static/common/js/service.js"></script>
    <script src="/static/js/notice.js"></script>
    <script src="/static/js/jquery.raty.min.js"></script>
    <script src="/static/production/finish_contract.min.js"></script>
    <script type="text/javascript">
      $(function(){
        orderRaty("evaluate1","e1",0,false);
        orderRaty("evaluate2","e2",0,false);
        orderRaty("evaluate3","e3",0,false);
        orderRaty("evaluate4","e4",0,false);
        orderRaty("evaluate5","e5",0,false);
        orderRaty("evaluate6","e6",0,false);
      })
      function orderRaty(_id, _inputId, _score, _readOnly) {
        $('#' + _id).raty({
          path : "/static/images/raty/",
          targetType: 'number',
          width: 230,
          score:_score, 
          readOnly:_readOnly,
          click: function(score, evt) {
            $('#'+_inputId).val(score);
            $('#score').html(calculateScore());
          }
        });
      }
      function calculateScore(){
        var score = 0;
        $(".start_list li>input").each(function(){
          if($(this).val()!=""){
            score += parseInt($(this).val());
          }
        })
        return (score/$(".start_list li").length).toFixed(2)
      }
    </script>
  </body>
</html>